# geom_point(aes(color = GroupCat), size = 4, alpha = 0.4) +
geom_text(aes(label=Compound, color=GroupCat), size = 3, alpha = 0.7) +
scale_color_manual(values=set_color) +
scale_fill_manual(values=set_color) +
scale_shape_manual(values=1:11) +
theme_minimal()
data.frame(Compound = compound, GroupCat = group_cat_text, data_pca) %>%
filter(GroupCat %in% c("Grp 3","Grp 5")) %>%
droplevels() %>%
plot_ly(x = ~PC1, y = ~PC2, z = ~PC3, color = ~GroupCat, text = ~Compound, colors = set_color[1:2]) %>%
add_markers(marker=list(size = 7, opacity = 0.6)) %>%
layout(scene = list(xaxis = list(title = 'PC1'),
yaxis = list(title = 'PC2'),
zaxis = list(title = 'PC3')),
title = "Cubic and Titled in the space of PC1, PC2, PC3")
fit = prcomp(data_biplot, cor=TRUE)
knitr::opts_chunk$set(
fig.align = "center",
fig.pos = "H",
fig.width = 10,
fig.height = 10,
message = FALSE,
warning = FALSE,
external = TRUE,
echo = TRUE
)
library(tidyverse)
library(magrittr)
library(plotly)
library(fastDummies)
library(ggalt)
library(reshape2)
library(RColorBrewer)
library(kableExtra)
library(ggsci)
library(cluster)
library(factoextra)
library(mclust)
library(neuralnet)
library(dendextend)  # color dendrogram
source("../R script/functions.R")
## Data Cleaning
# load raw data files
data = read.csv("../data/filledDatabase111119NUMONLY.csv")
# clean data
data = clean_data(data)
# separate compound and group_cate from the predictors
compound = data$Compound
group_cat = data$GroupCat
X = data$X
group_cat_text = paste("Grp", group_cat)
data = select(data, -c("Compound","GroupCat","X"))
data_matrix = data %>% as.matrix()
model_complete = hclust( dist(data_matrix), method = "complete" )
## use elbow ... etc to decide K
summary(X) %>%
as.data.frame() %>%
set_colnames("Frequency") %>%
rownames_to_column("X") %>%
arrange(desc(Frequency)) %>%
t() %>%
kable(caption = "Frequency table for cluster X of data version 11/11/19") %>%
kable_styling(bootstrap_options = "striped")
rows_to_take = 1:nrow(data)
subset = data[rows_to_take, ]
compound_sub = compound[rows_to_take]
group_cat_sub = group_cat[rows_to_take]
group_cat_text_sub = group_cat_text[rows_to_take]
set_color = c("#0071C3","#DE501A","#EEB020","#7E2E8E","#79AC2C","#4DBDF7","#A51331") %>%
rep(10)
# extract three two PC's
data_pca = get_pc_space(subset, k = 3) %>% scale()
# plot
data.frame(Compound = compound_sub, GroupCat = group_cat_text_sub, data_pca) %>%
ggplot(aes(x=PC1, y=PC2, color = GroupCat)) +
geom_point(aes(color = GroupCat), size = 2, alpha = 0.4) +
geom_text(aes(label=Compound, color=GroupCat), size = 3) +
scale_color_manual(values=set_color) +
scale_fill_manual(values=set_color) +
scale_shape_manual(values=1:11) +
theme_minimal()
## Data Cleaning
# load raw data files
data = read.csv("../data/filledDatabase111119NUMONLY.csv")
# clean data
data = clean_data(data)
# separate compound and group_cate from the predictors
compound = data$Compound
group_cat = data$GroupCat
X = data$X
group_cat_text = paste("Grp", group_cat)
data = select(data, -c("Compound","GroupCat","X"))
knitr::opts_chunk$set(
fig.align = "center",
fig.pos = "H",
fig.width = 10,
fig.height = 10,
message = FALSE,
warning = FALSE,
external = TRUE,
echo = TRUE
)
library(tidyverse)
library(magrittr)
library(plotly)
library(fastDummies)
library(ggalt)
library(reshape2)
library(RColorBrewer)
library(kableExtra)
library(ggsci)
library(cluster)
library(factoextra)
library(mclust)
library(neuralnet)
library(dendextend)  # color dendrogram
source("../R script/functions.R")
## Data Cleaning
# load raw data files
data = read.csv("../data/filledDatabase111119NUMONLY.csv")
# clean data
data = clean_data(data)
# separate compound and group_cate from the predictors
compound = data$Compound
group_cat = data$GroupCat
X = data$X
group_cat_text = paste("Grp", group_cat)
data = select(data, -c("Compound","GroupCat","X"))
data_matrix = data %>% as.matrix()
model_complete = hclust( dist(data_matrix), method = "complete" )
## use elbow ... etc to decide K
summary(X) %>%
as.data.frame() %>%
set_colnames("Frequency") %>%
rownames_to_column("X") %>%
arrange(desc(Frequency)) %>%
t() %>%
kable(caption = "Frequency table for cluster X of data version 11/11/19") %>%
kable_styling(bootstrap_options = "striped")
rows_to_take = 1:nrow(data)
subset = data[rows_to_take, ]
compound_sub = compound[rows_to_take]
group_cat_sub = group_cat[rows_to_take]
group_cat_text_sub = group_cat_text[rows_to_take]
set_color = c("#0071C3","#DE501A","#EEB020","#7E2E8E","#79AC2C","#4DBDF7","#A51331") %>%
rep(10)
# extract three two PC's
data_pca = get_pc_space(subset, k = 3) %>% scale()
# plot
data.frame(Compound = compound_sub, GroupCat = group_cat_text_sub, data_pca) %>%
ggplot(aes(x=PC1, y=PC2, color = GroupCat)) +
geom_point(aes(color = GroupCat), size = 2, alpha = 0.4) +
geom_text(aes(label=Compound, color=GroupCat), size = 3) +
scale_color_manual(values=set_color) +
scale_fill_manual(values=set_color) +
scale_shape_manual(values=1:11) +
theme_minimal()
rows_to_take = 1:nrow(data)
subset = data[rows_to_take, ]
compound_sub = compound[rows_to_take]
group_cat_sub = group_cat[rows_to_take]
group_cat_text_sub = group_cat_text[rows_to_take]
set_color = c("#0071C3","#DE501A","#EEB020","#7E2E8E","#79AC2C","#4DBDF7","#A51331") %>%
rep(10)
# extract three two PC's
data_pca = get_pc_space(subset, k = 3)
# plot
data.frame(Compound = compound_sub, GroupCat = group_cat_text_sub, data_pca) %>%
ggplot(aes(x=PC1, y=PC2, color = GroupCat)) +
geom_point(aes(color = GroupCat), size = 2, alpha = 0.4) +
geom_text(aes(label=Compound, color=GroupCat), size = 3) +
scale_color_manual(values=set_color) +
scale_fill_manual(values=set_color) +
scale_shape_manual(values=1:11) +
theme_minimal()
View(data_pca)
group_cat_sub
group_cat_text_sub
compound_sub
rows_to_take = c(1:nrow(data))
subset = data[rows_to_take, ]
compound_sub = compound[rows_to_take]
group_cat_sub = group_cat[rows_to_take]
group_cat_text_sub = group_cat_text[rows_to_take]
set_color = c("#0071C3","#DE501A","#EEB020","#7E2E8E","#79AC2C","#4DBDF7","#A51331") %>%
rep(10)
# extract three two PC's
data_pca = get_pc_space(subset, k = 3) %>% scale()
# plot
data.frame(Compound = compound_sub, GroupCat = group_cat_text_sub, data_pca) %>%
ggplot(aes(x=PC1, y=PC2, color = GroupCat)) +
geom_point(aes(color = GroupCat), size = 2, alpha = 0.4) +
geom_text(aes(label=Compound, color=GroupCat), size = 3) +
scale_color_manual(values=set_color) +
scale_fill_manual(values=set_color) +
scale_shape_manual(values=1:11) +
theme_minimal()
knitr::opts_chunk$set(
fig.align = "center",
fig.pos = "H",
fig.width = 10,
fig.height = 10,
message = FALSE,
warning = FALSE,
external = TRUE,
echo = TRUE
)
library(tidyverse)
library(magrittr)
library(plotly)
library(fastDummies)
library(ggalt)
library(reshape2)
library(RColorBrewer)
library(kableExtra)
library(ggsci)
library(cluster)
library(factoextra)
library(mclust)
library(neuralnet)
library(dendextend)  # color dendrogram
source("../R script/functions.R")
## Data Cleaning
# load raw data files
data = read.csv("../data/filledDatabase111119NUMONLY.csv")
# clean data
data = clean_data(data)
# separate compound and group_cate from the predictors
compound = data$Compound
group_cat = data$GroupCat
X = data$X
group_cat_text = paste("Grp", group_cat)
data = select(data, -c("Compound","GroupCat","X"))
data_matrix = data %>% as.matrix()
model_complete = hclust( dist(data_matrix), method = "complete" )
## use elbow ... etc to decide K
summary(X) %>%
as.data.frame() %>%
set_colnames("Frequency") %>%
rownames_to_column("X") %>%
arrange(desc(Frequency)) %>%
t() %>%
kable(caption = "Frequency table for cluster X of data version 11/11/19") %>%
kable_styling(bootstrap_options = "striped")
## Data Cleaning
# load raw data files
data = read.csv("../data/filledDatabase111119NUMONLY.csv")
# clean data
data = clean_data(data)
# separate compound and group_cate from the predictors
compound = data$Compound
group_cat = data$GroupCat
X = data$X
group_cat_text = paste("Grp", group_cat)
data = select(data, -c("Compound","GroupCat","X"))
rows_to_take = c(1:nrow(data))
subset = data[rows_to_take, ]
compound_sub = compound[rows_to_take]
group_cat_sub = group_cat[rows_to_take]
group_cat_text_sub = group_cat_text[rows_to_take]
set_color = c("#0071C3","#DE501A","#EEB020","#7E2E8E","#79AC2C","#4DBDF7","#A51331") %>%
rep(10)
# extract three two PC's
data_pca = get_pc_space(subset, k = 3) %>% scale()
# plot
data.frame(Compound = compound_sub, GroupCat = group_cat_text_sub, data_pca) %>%
ggplot(aes(x=PC1, y=PC2, color = GroupCat)) +
geom_point(aes(color = GroupCat), size = 2, alpha = 0.4) +
geom_text(aes(label=Compound, color=GroupCat), size = 3) +
scale_color_manual(values=set_color) +
scale_fill_manual(values=set_color) +
scale_shape_manual(values=1:11) +
theme_minimal()
library(tidyverse)
library(magrittr)
library(fastDummies)
library(ggalt)
library(reshape2)
library(RColorBrewer)
library(ggsci)
library(cluster)
library(factoextra)
library(mclust)
library(neuralnet)
library(dendextend)
data = read.csv("./Dropbox (CSU Fullerton)/Research Project/Solid State Chemistry/ChemStatsResearch/Chem Stats R code/data/filledDatabase10042019NUMonlyREDUCED.csv")
source("./Dropbox (CSU Fullerton)/Research Project/Solid State Chemistry/ChemStatsResearch/Chem Stats R code/R script/functions.R")
data = read.csv("./Dropbox (CSU Fullerton)/Research Project/Solid State Chemistry/ChemStatsResearch/Chem Stats R code/data/filledDatabase10042019NUMonlyREDUCED.csv")
data = read.csv("../Dropbox (CSU Fullerton)/Research Project/Solid State Chemistry/ChemStatsResearch/Chem Stats R code/data/filledDatabase10042019NUMonlyREDUCED.csv")
data = read.csv("./Dropbox (CSU Fullerton)/Research Project/Solid State Chemistry/ChemStatsResearch/Chem Stats R code/data/filledDatabase10042019NUMonlyREDUCED.csv")
getwd()
data = read.csv("./data/filledDatabase10042019NUMonlyREDUCED.csv")
source("./R script/functions.R")
data = clean_data(data)
compound = data$Compound
group_cat = data$GroupCat
group_cat_text = paste("Grp", group_cat)
data = select(data, -c("Compound","GroupCat"))
data_biplot = data
data_pca = get_pc_space(data, k = 17) %>% scale()
set_color = c("#0071C3","#DE501A","#EEB020","#7E2E8E","#79AC2C","#4DBDF7","#A51331") %>%
rep(10)
data.frame(Compound = compound, GroupCat = group_cat_text, data_pca) %>%
ggplot(aes(x=PC1, y=PC2, color = GroupCat)) +
# geom_point(aes(color = GroupCat), size = 3, alpha = 0.4) +
geom_text(aes(label=Compound, color=GroupCat), size = 4) +
scale_color_manual(values=set_color) +
scale_fill_manual(values=set_color) +
scale_shape_manual(values=1:11) +
theme_minimal() +
labs(color="")
set_color = c("#0071C3","#DE501A","#EEB020","#7E2E8E","#79AC2C","#A51331","#4DBDF7") %>%
rep(10)
data.frame(Compound = compound, GroupCat = group_cat_text, data_pca) %>%
ggplot(aes(x=PC1, y=PC2, color = GroupCat)) +
# geom_point(aes(color = GroupCat), size = 3, alpha = 0.4) +
geom_text(aes(label=Compound, color=GroupCat), size = 4) +
scale_color_manual(values=set_color) +
scale_fill_manual(values=set_color) +
scale_shape_manual(values=1:11) +
theme_minimal() +
labs(color="")
rownames(data_biplot) = make.names(compound, unique=TRUE)
fit <- princomp(data_biplot, cor=TRUE)
fviz_pca_biplot(fit, aesx = c(1,2),
# individual
label = "var", labelsize = 4,
geom = c("point","text"),
fill.ind = group_cat_text, alpha.ind = 0.7,
pointsize = 1,
pointshape = 21,
palette = set_color[1:11],
# variable
col.var = "contrib",
gradient.cols = c("#00AFBB","orange1","#FC4E07"),
repel=FALSE) +
labs(title="",
fill = "",
color = "Contribution",
x = "PC1",
y = "PC2")
data.frame(Compound = compound, GroupCat = group_cat_text, data_pca) %>%
filter(GroupCat %in% c("Grp 3","Grp 5")) %>%
ggplot(aes(x=PC1, y=PC2, color = GroupCat)) +
# geom_point(aes(color = GroupCat), size = 4, alpha = 0.4) +
geom_text(aes(label=Compound, color=GroupCat), size = 4, alpha = 0.7) +
scale_color_manual(values=set_color) +
scale_fill_manual(values=set_color) +
scale_shape_manual(values=1:11) +
theme_minimal() +
labs(color="")
set_color2 = c("#A51331","#0071C3")
set_color2 = c("#A51331","#0071C3")
data.frame(Compound = compound, GroupCat = group_cat_text, data_pca) %>%
filter(GroupCat %in% c("Grp 3","Grp 5")) %>%
ggplot(aes(x=PC1, y=PC2, color = GroupCat)) +
# geom_point(aes(color = GroupCat), size = 4, alpha = 0.4) +
geom_text(aes(label=Compound, color=GroupCat), size = 4, alpha = 0.7) +
scale_color_manual(values=set_color2) +
scale_fill_manual(values=set_color2) +
scale_shape_manual(values=1:11) +
theme_minimal() +
labs(color="")
rownames(data_biplot) = make.names(compound, unique=TRUE)
fit <- princomp(data_biplot, cor=TRUE)
fviz_pca_biplot(fit, aesx = c(1,2),
# individual
label = "var", labelsize = 4,
geom = c("point","text"),
fill.ind = group_cat_text, alpha.ind = 0.7,
pointsize = 1,
pointshape = 21,
palette = set_color[1:11],
# variable
col.var = "contrib",
gradient.cols = c("#00AFBB","orange1","#FC4E07"),
repel=FALSE) +
labs(title="",
fill = "",
color = "Contribution",
x = "PC1",
y = "PC2")
fviz_pca_biplot(fit, aesx = c(1,2),
# individual
label = "var", labelsize = 4,
geom = c("point","text"),
fill.ind = group_cat_text, alpha.ind = 0.7,
pointsize = 1,
pointshape = 21,
palette = set_color[1:11],
# variable
col.var = "contrib",
gradient.cols = c("#00AFBB","orange1","#FC4E07"),
repel=TRUE) +
labs(title="",
fill = "",
color = "Contribution",
x = "PC1",
y = "PC2")
fviz_pca_biplot(fit, aesx = c(1,2),
# individual
label = "var", labelsize = 4,
geom = c("point","text"),
fill.ind = group_cat_text, alpha.ind = 0.7,
pointsize = 1,
pointshape = 21,
palette = set_color[1:11],
# variable
col.var = "contrib",
gradient.cols = c("#00AFBB","orange1","#FC4E07"),
repel=TRUE) +
labs(title="",
fill = "",
color = "Contribution",
x = "PC1",
y = "PC2") +
ylim(-2,4)
data.frame(Compound = compound, GroupCat = group_cat_text, data_pca) %>%
filter(GroupCat %in% c("Grp 3","Grp 5")) %>%
ggplot(aes(x=PC1, y=PC2, color = GroupCat)) +
# geom_point(aes(color = GroupCat), size = 4, alpha = 0.4) +
geom_text(aes(label=Compound, color=GroupCat), size = 4, alpha = 0.7) +
scale_color_manual(values=set_color2) +
scale_fill_manual(values=set_color2) +
scale_shape_manual(values=1:11) +
theme_minimal() +
labs(color="") +
ylim(-2,4)
data.frame(Compound = compound, GroupCat = group_cat_text, data_pca) %>%
filter(GroupCat %in% c("Grp 3","Grp 5")) %>%
ggplot(aes(x=PC1, y=PC2, color = GroupCat)) +
# geom_point(aes(color = GroupCat), size = 4, alpha = 0.4) +
geom_text(aes(label=Compound, color=GroupCat), size = 4, alpha = 0.7) +
scale_color_manual(values=set_color2) +
scale_fill_manual(values=set_color2) +
scale_shape_manual(values=1:11) +
theme_minimal() +
labs(color="") +
ylim(-2.5,4.5)
data.frame(Compound = compound, GroupCat = group_cat_text, data_pca) %>%
ggplot(aes(x=PC1, y=PC2, color = GroupCat)) +
# geom_point(aes(color = GroupCat), size = 3, alpha = 0.4) +
geom_text(aes(label=Compound, color=GroupCat), size = 4) +
scale_color_manual(values=set_color) +
scale_fill_manual(values=set_color) +
scale_shape_manual(values=1:11) +
theme_minimal() +
labs(color="") +
ylim(-2.5,4.5)
data.frame(Compound = compound, GroupCat = group_cat_text, data_pca) %>%
ggplot(aes(x=PC1, y=PC2, color = GroupCat)) +
# geom_point(aes(color = GroupCat), size = 3, alpha = 0.4) +
geom_text(aes(label=Compound, color=GroupCat), size = 4) +
scale_color_manual(values=set_color) +
scale_fill_manual(values=set_color) +
scale_shape_manual(values=1:11) +
theme_minimal() +
labs(color="") +
ylim(-3,4.5)
data.frame(Compound = compound, GroupCat = group_cat_text, data_pca) %>%
filter(GroupCat %in% c("Grp 3","Grp 5")) %>%
ggplot(aes(x=PC1, y=PC2, color = GroupCat)) +
# geom_point(aes(color = GroupCat), size = 4, alpha = 0.4) +
geom_text(aes(label=Compound, color=GroupCat), size = 4, alpha = 0.7) +
scale_color_manual(values=set_color2) +
scale_fill_manual(values=set_color2) +
scale_shape_manual(values=1:11) +
theme_minimal() +
labs(color="") +
ylim(-3,4.5)
data.frame(Compound = compound, GroupCat = group_cat_text, data_pca) %>%
filter(GroupCat %in% c("Grp 3","Grp 5")) %>%
ggplot(aes(x=PC1, y=PC2, color = GroupCat)) +
# geom_point(aes(color = GroupCat), size = 4, alpha = 0.4) +
geom_text(aes(label=Compound, color=GroupCat), size = 4, alpha = 0.7) +
scale_color_manual(values=set_color2) +
scale_fill_manual(values=set_color2) +
scale_shape_manual(values=1:11) +
theme_minimal() +
labs(color="") +
ylim(-3,4.5) +
xlim(-2.5,2.5)
data.frame(Compound = compound, GroupCat = group_cat_text, data_pca) %>%
ggplot(aes(x=PC1, y=PC2, color = GroupCat)) +
# geom_point(aes(color = GroupCat), size = 3, alpha = 0.4) +
geom_text(aes(label=Compound, color=GroupCat), size = 4) +
scale_color_manual(values=set_color) +
scale_fill_manual(values=set_color) +
scale_shape_manual(values=1:11) +
theme_minimal() +
labs(color="") +
ylim(-3,4.5) +
xlim(-2.5,2.5)
rownames(data_biplot) = make.names(compound, unique=TRUE)
fit <- princomp(data_biplot, cor=TRUE)
fviz_pca_biplot(fit, aesx = c(1,2),
# individual
label = "var", labelsize = 4,
geom = c("point","text"),
fill.ind = group_cat_text, alpha.ind = 0.7,
pointsize = 1,
pointshape = 21,
palette = set_color[1:11],
# variable
col.var = "contrib",
gradient.cols = c("#00AFBB","orange1","#FC4E07"),
repel=TRUE) +
labs(title="",
fill = "",
color = "Contribution",
x = "PC1",
y = "PC2")
